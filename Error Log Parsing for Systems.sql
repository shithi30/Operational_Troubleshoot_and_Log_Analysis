/*
- Viz: 
- Data: 
- Function: 
- Table:
- File: 
- Path: 
- Document/Presentation/Dashboard: 
- Email thread: 
- Notes (if any): This was done for Systems, runnable on MySQL, Skype Mahidul Hasan convo. can be looked up
*/

/* 
Paste this to your DBeaver window and run.
This code-snippet can be generalized by replacing the json with the column-name, for 'FAILED' cases.
*/

select 
	-- id
	substring_index(substring_index(substring_index(substring_index("{'3DSecure': {'acsEci': '05', 'authenticationStatus': 'AUTHENTICATION_SUCCESSFUL', 'authenticationToken': 'AAACBihBGUmHI4lCOEEZELajZkI=', 'enrollmentStatus': 'ENROLLED', 'xid': '9lpbKfZXFG/CBMm1/06wPvrbkV4='}, 'authorizationResponse': {'cardLevelIndicator': 'N ', 'cardSecurityCodeError': 'P', 'commercialCard': '!01', 'commercialCardIndicator': '0', 'date': '0824', 'posData': '1025100006600', 'posEntryMode': '812', 'processingCode': '000000', 'responseCode': '54', 'returnAci': 'N', 'stan': '242077', 'time': '070019', 'transactionIdentifier': '301236252199379', 'validationCode': 'NA  ', 'vpasResponse': '2'}, 'device': {'browser': 'Mozilla/5.0 (Linux; Android 10; ONEPLUS A6000 Build/QKQ1.190716.003; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/92.0.4515.159 Mobile Safari/537.36', 'ipAddress': '202.152.70.197'}, 'gatewayEntryPoint': 'WEB_SERVICES_API', 'merchant': '50400002', 'order': {'amount': 95.0, 'creationTime': '2021-08-24T07:00:19.692Z', 'currency': 'BDT', 'id': 'ord_d98f3c68e22b4699bd9feff10770898d', 'status': 'FAILED', 'totalAuthorizedAmount': 0.0, 'totalCapturedAmount': 0.0, 'totalRefundedAmount': 0.0}, 'response': {'acquirerCode': '54', 'acquirerMessage': 'Expired card', 'cardSecurityCode': {'acquirerCode': 'P', 'gatewayCode': 'NOT_PROCESSED'}, 'gatewayCode': 'EXPIRED_CARD'}, 'result': 'FAILURE', 'sourceOfFunds': {'provided': {'card': {'brand': 'VISA', 'expiry': {'month': '9', 'year': '26'}, 'fundingMethod': 'CREDIT', 'number': '413401xxxxxx4099', 'scheme': 'VISA'}}, 'type': 'CARD'}, 'timeOfRecord': '2021-08-24T07:00:19.719Z', 'transaction': {'acquirer': {'batch': 20210824, 'date': '0824', 'id': 'EASTERNBANK_S2I', 'merchantId': '50400002', 'settlementDate': '2021-08-24', 'timeZone': '+0600', 'transactionId': '301236252199379'}, 'amount': 95.0, 'currency': 'BDT', 'frequency': 'SINGLE', 'id': '1cb11ffb-3d20-4dbe-a738-df282b06ac0e', 'receipt': '123607242077', 'source': 'INTERNET', 'terminal': 'EASS2I05', 'type': 'PAYMENT'}, 'version': '43'}", "'id': ", -2), ",", 1), "'", -2), "'", 1) id,
	-- status
	substring_index(substring_index(substring_index(substring_index("{'3DSecure': {'acsEci': '05', 'authenticationStatus': 'AUTHENTICATION_SUCCESSFUL', 'authenticationToken': 'AAACBihBGUmHI4lCOEEZELajZkI=', 'enrollmentStatus': 'ENROLLED', 'xid': '9lpbKfZXFG/CBMm1/06wPvrbkV4='}, 'authorizationResponse': {'cardLevelIndicator': 'N ', 'cardSecurityCodeError': 'P', 'commercialCard': '!01', 'commercialCardIndicator': '0', 'date': '0824', 'posData': '1025100006600', 'posEntryMode': '812', 'processingCode': '000000', 'responseCode': '54', 'returnAci': 'N', 'stan': '242077', 'time': '070019', 'transactionIdentifier': '301236252199379', 'validationCode': 'NA  ', 'vpasResponse': '2'}, 'device': {'browser': 'Mozilla/5.0 (Linux; Android 10; ONEPLUS A6000 Build/QKQ1.190716.003; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/92.0.4515.159 Mobile Safari/537.36', 'ipAddress': '202.152.70.197'}, 'gatewayEntryPoint': 'WEB_SERVICES_API', 'merchant': '50400002', 'order': {'amount': 95.0, 'creationTime': '2021-08-24T07:00:19.692Z', 'currency': 'BDT', 'id': 'ord_d98f3c68e22b4699bd9feff10770898d', 'status': 'FAILED', 'totalAuthorizedAmount': 0.0, 'totalCapturedAmount': 0.0, 'totalRefundedAmount': 0.0}, 'response': {'acquirerCode': '54', 'acquirerMessage': 'Expired card', 'cardSecurityCode': {'acquirerCode': 'P', 'gatewayCode': 'NOT_PROCESSED'}, 'gatewayCode': 'EXPIRED_CARD'}, 'result': 'FAILURE', 'sourceOfFunds': {'provided': {'card': {'brand': 'VISA', 'expiry': {'month': '9', 'year': '26'}, 'fundingMethod': 'CREDIT', 'number': '413401xxxxxx4099', 'scheme': 'VISA'}}, 'type': 'CARD'}, 'timeOfRecord': '2021-08-24T07:00:19.719Z', 'transaction': {'acquirer': {'batch': 20210824, 'date': '0824', 'id': 'EASTERNBANK_S2I', 'merchantId': '50400002', 'settlementDate': '2021-08-24', 'timeZone': '+0600', 'transactionId': '301236252199379'}, 'amount': 95.0, 'currency': 'BDT', 'frequency': 'SINGLE', 'id': '1cb11ffb-3d20-4dbe-a738-df282b06ac0e', 'receipt': '123607242077', 'source': 'INTERNET', 'terminal': 'EASS2I05', 'type': 'PAYMENT'}, 'version': '43'}", "'status': ", -1), ",", 1), "'", -2), "'", 1) status,
	-- creation_time
	cast(substring_index(substring_index(substring_index(substring_index("{'3DSecure': {'acsEci': '05', 'authenticationStatus': 'AUTHENTICATION_SUCCESSFUL', 'authenticationToken': 'AAACBihBGUmHI4lCOEEZELajZkI=', 'enrollmentStatus': 'ENROLLED', 'xid': '9lpbKfZXFG/CBMm1/06wPvrbkV4='}, 'authorizationResponse': {'cardLevelIndicator': 'N ', 'cardSecurityCodeError': 'P', 'commercialCard': '!01', 'commercialCardIndicator': '0', 'date': '0824', 'posData': '1025100006600', 'posEntryMode': '812', 'processingCode': '000000', 'responseCode': '54', 'returnAci': 'N', 'stan': '242077', 'time': '070019', 'transactionIdentifier': '301236252199379', 'validationCode': 'NA  ', 'vpasResponse': '2'}, 'device': {'browser': 'Mozilla/5.0 (Linux; Android 10; ONEPLUS A6000 Build/QKQ1.190716.003; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/92.0.4515.159 Mobile Safari/537.36', 'ipAddress': '202.152.70.197'}, 'gatewayEntryPoint': 'WEB_SERVICES_API', 'merchant': '50400002', 'order': {'amount': 95.0, 'creationTime': '2021-08-24T07:00:19.692Z', 'currency': 'BDT', 'id': 'ord_d98f3c68e22b4699bd9feff10770898d', 'status': 'FAILED', 'totalAuthorizedAmount': 0.0, 'totalCapturedAmount': 0.0, 'totalRefundedAmount': 0.0}, 'response': {'acquirerCode': '54', 'acquirerMessage': 'Expired card', 'cardSecurityCode': {'acquirerCode': 'P', 'gatewayCode': 'NOT_PROCESSED'}, 'gatewayCode': 'EXPIRED_CARD'}, 'result': 'FAILURE', 'sourceOfFunds': {'provided': {'card': {'brand': 'VISA', 'expiry': {'month': '9', 'year': '26'}, 'fundingMethod': 'CREDIT', 'number': '413401xxxxxx4099', 'scheme': 'VISA'}}, 'type': 'CARD'}, 'timeOfRecord': '2021-08-24T07:00:19.719Z', 'transaction': {'acquirer': {'batch': 20210824, 'date': '0824', 'id': 'EASTERNBANK_S2I', 'merchantId': '50400002', 'settlementDate': '2021-08-24', 'timeZone': '+0600', 'transactionId': '301236252199379'}, 'amount': 95.0, 'currency': 'BDT', 'frequency': 'SINGLE', 'id': '1cb11ffb-3d20-4dbe-a738-df282b06ac0e', 'receipt': '123607242077', 'source': 'INTERNET', 'terminal': 'EASS2I05', 'type': 'PAYMENT'}, 'version': '43'}", "'creationTime': ", -1), ",", 1), "'", -2), "'", 1) as datetime) creation_time,       
	-- gateway code
	substring_index(substring_index(substring_index(substring_index("{'3DSecure': {'acsEci': '05', 'authenticationStatus': 'AUTHENTICATION_SUCCESSFUL', 'authenticationToken': 'AAACBihBGUmHI4lCOEEZELajZkI=', 'enrollmentStatus': 'ENROLLED', 'xid': '9lpbKfZXFG/CBMm1/06wPvrbkV4='}, 'authorizationResponse': {'cardLevelIndicator': 'N ', 'cardSecurityCodeError': 'P', 'commercialCard': '!01', 'commercialCardIndicator': '0', 'date': '0824', 'posData': '1025100006600', 'posEntryMode': '812', 'processingCode': '000000', 'responseCode': '54', 'returnAci': 'N', 'stan': '242077', 'time': '070019', 'transactionIdentifier': '301236252199379', 'validationCode': 'NA  ', 'vpasResponse': '2'}, 'device': {'browser': 'Mozilla/5.0 (Linux; Android 10; ONEPLUS A6000 Build/QKQ1.190716.003; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/92.0.4515.159 Mobile Safari/537.36', 'ipAddress': '202.152.70.197'}, 'gatewayEntryPoint': 'WEB_SERVICES_API', 'merchant': '50400002', 'order': {'amount': 95.0, 'creationTime': '2021-08-24T07:00:19.692Z', 'currency': 'BDT', 'id': 'ord_d98f3c68e22b4699bd9feff10770898d', 'status': 'FAILED', 'totalAuthorizedAmount': 0.0, 'totalCapturedAmount': 0.0, 'totalRefundedAmount': 0.0}, 'response': {'acquirerCode': '54', 'acquirerMessage': 'Expired card', 'cardSecurityCode': {'acquirerCode': 'P', 'gatewayCode': 'NOT_PROCESSED'}, 'gatewayCode': 'EXPIRED_CARD'}, 'result': 'FAILURE', 'sourceOfFunds': {'provided': {'card': {'brand': 'VISA', 'expiry': {'month': '9', 'year': '26'}, 'fundingMethod': 'CREDIT', 'number': '413401xxxxxx4099', 'scheme': 'VISA'}}, 'type': 'CARD'}, 'timeOfRecord': '2021-08-24T07:00:19.719Z', 'transaction': {'acquirer': {'batch': 20210824, 'date': '0824', 'id': 'EASTERNBANK_S2I', 'merchantId': '50400002', 'settlementDate': '2021-08-24', 'timeZone': '+0600', 'transactionId': '301236252199379'}, 'amount': 95.0, 'currency': 'BDT', 'frequency': 'SINGLE', 'id': '1cb11ffb-3d20-4dbe-a738-df282b06ac0e', 'receipt': '123607242077', 'source': 'INTERNET', 'terminal': 'EASS2I05', 'type': 'PAYMENT'}, 'version': '43'}", "'gatewayCode': ", -1), ",", 1), "'", -2), "'", 1) gateway_code,
	-- type
	substring_index(substring_index(substring_index(substring_index("{'3DSecure': {'acsEci': '05', 'authenticationStatus': 'AUTHENTICATION_SUCCESSFUL', 'authenticationToken': 'AAACBihBGUmHI4lCOEEZELajZkI=', 'enrollmentStatus': 'ENROLLED', 'xid': '9lpbKfZXFG/CBMm1/06wPvrbkV4='}, 'authorizationResponse': {'cardLevelIndicator': 'N ', 'cardSecurityCodeError': 'P', 'commercialCard': '!01', 'commercialCardIndicator': '0', 'date': '0824', 'posData': '1025100006600', 'posEntryMode': '812', 'processingCode': '000000', 'responseCode': '54', 'returnAci': 'N', 'stan': '242077', 'time': '070019', 'transactionIdentifier': '301236252199379', 'validationCode': 'NA  ', 'vpasResponse': '2'}, 'device': {'browser': 'Mozilla/5.0 (Linux; Android 10; ONEPLUS A6000 Build/QKQ1.190716.003; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/92.0.4515.159 Mobile Safari/537.36', 'ipAddress': '202.152.70.197'}, 'gatewayEntryPoint': 'WEB_SERVICES_API', 'merchant': '50400002', 'order': {'amount': 95.0, 'creationTime': '2021-08-24T07:00:19.692Z', 'currency': 'BDT', 'id': 'ord_d98f3c68e22b4699bd9feff10770898d', 'status': 'FAILED', 'totalAuthorizedAmount': 0.0, 'totalCapturedAmount': 0.0, 'totalRefundedAmount': 0.0}, 'response': {'acquirerCode': '54', 'acquirerMessage': 'Expired card', 'cardSecurityCode': {'acquirerCode': 'P', 'gatewayCode': 'NOT_PROCESSED'}, 'gatewayCode': 'EXPIRED_CARD'}, 'result': 'FAILURE', 'sourceOfFunds': {'provided': {'card': {'brand': 'VISA', 'expiry': {'month': '9', 'year': '26'}, 'fundingMethod': 'CREDIT', 'number': '413401xxxxxx4099', 'scheme': 'VISA'}}, 'type': 'CARD'}, 'timeOfRecord': '2021-08-24T07:00:19.719Z', 'transaction': {'acquirer': {'batch': 20210824, 'date': '0824', 'id': 'EASTERNBANK_S2I', 'merchantId': '50400002', 'settlementDate': '2021-08-24', 'timeZone': '+0600', 'transactionId': '301236252199379'}, 'amount': 95.0, 'currency': 'BDT', 'frequency': 'SINGLE', 'id': '1cb11ffb-3d20-4dbe-a738-df282b06ac0e', 'receipt': '123607242077', 'source': 'INTERNET', 'terminal': 'EASS2I05', 'type': 'PAYMENT'}, 'version': '43'}", "'type': ", -1), ",", 1), "'", -2), "'", 1) type,
	-- txn_id
	substring_index(substring_index(substring_index(substring_index("{'3DSecure': {'acsEci': '05', 'authenticationStatus': 'AUTHENTICATION_SUCCESSFUL', 'authenticationToken': 'AAACBihBGUmHI4lCOEEZELajZkI=', 'enrollmentStatus': 'ENROLLED', 'xid': '9lpbKfZXFG/CBMm1/06wPvrbkV4='}, 'authorizationResponse': {'cardLevelIndicator': 'N ', 'cardSecurityCodeError': 'P', 'commercialCard': '!01', 'commercialCardIndicator': '0', 'date': '0824', 'posData': '1025100006600', 'posEntryMode': '812', 'processingCode': '000000', 'responseCode': '54', 'returnAci': 'N', 'stan': '242077', 'time': '070019', 'transactionIdentifier': '301236252199379', 'validationCode': 'NA  ', 'vpasResponse': '2'}, 'device': {'browser': 'Mozilla/5.0 (Linux; Android 10; ONEPLUS A6000 Build/QKQ1.190716.003; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/92.0.4515.159 Mobile Safari/537.36', 'ipAddress': '202.152.70.197'}, 'gatewayEntryPoint': 'WEB_SERVICES_API', 'merchant': '50400002', 'order': {'amount': 95.0, 'creationTime': '2021-08-24T07:00:19.692Z', 'currency': 'BDT', 'id': 'ord_d98f3c68e22b4699bd9feff10770898d', 'status': 'FAILED', 'totalAuthorizedAmount': 0.0, 'totalCapturedAmount': 0.0, 'totalRefundedAmount': 0.0}, 'response': {'acquirerCode': '54', 'acquirerMessage': 'Expired card', 'cardSecurityCode': {'acquirerCode': 'P', 'gatewayCode': 'NOT_PROCESSED'}, 'gatewayCode': 'EXPIRED_CARD'}, 'result': 'FAILURE', 'sourceOfFunds': {'provided': {'card': {'brand': 'VISA', 'expiry': {'month': '9', 'year': '26'}, 'fundingMethod': 'CREDIT', 'number': '413401xxxxxx4099', 'scheme': 'VISA'}}, 'type': 'CARD'}, 'timeOfRecord': '2021-08-24T07:00:19.719Z', 'transaction': {'acquirer': {'batch': 20210824, 'date': '0824', 'id': 'EASTERNBANK_S2I', 'merchantId': '50400002', 'settlementDate': '2021-08-24', 'timeZone': '+0600', 'transactionId': '301236252199379'}, 'amount': 95.0, 'currency': 'BDT', 'frequency': 'SINGLE', 'id': '1cb11ffb-3d20-4dbe-a738-df282b06ac0e', 'receipt': '123607242077', 'source': 'INTERNET', 'terminal': 'EASS2I05', 'type': 'PAYMENT'}, 'version': '43'}", "'transactionId': ", -1), ",", 1), "'", -2), "'", 1) txn_id,
	-- amount
	cast(substring_index(substring_index(substring_index(substring_index("{'3DSecure': {'acsEci': '05', 'authenticationStatus': 'AUTHENTICATION_SUCCESSFUL', 'authenticationToken': 'AAACBihBGUmHI4lCOEEZELajZkI=', 'enrollmentStatus': 'ENROLLED', 'xid': '9lpbKfZXFG/CBMm1/06wPvrbkV4='}, 'authorizationResponse': {'cardLevelIndicator': 'N ', 'cardSecurityCodeError': 'P', 'commercialCard': '!01', 'commercialCardIndicator': '0', 'date': '0824', 'posData': '1025100006600', 'posEntryMode': '812', 'processingCode': '000000', 'responseCode': '54', 'returnAci': 'N', 'stan': '242077', 'time': '070019', 'transactionIdentifier': '301236252199379', 'validationCode': 'NA  ', 'vpasResponse': '2'}, 'device': {'browser': 'Mozilla/5.0 (Linux; Android 10; ONEPLUS A6000 Build/QKQ1.190716.003; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/92.0.4515.159 Mobile Safari/537.36', 'ipAddress': '202.152.70.197'}, 'gatewayEntryPoint': 'WEB_SERVICES_API', 'merchant': '50400002', 'order': {'amount': 95.0, 'creationTime': '2021-08-24T07:00:19.692Z', 'currency': 'BDT', 'id': 'ord_d98f3c68e22b4699bd9feff10770898d', 'status': 'FAILED', 'totalAuthorizedAmount': 0.0, 'totalCapturedAmount': 0.0, 'totalRefundedAmount': 0.0}, 'response': {'acquirerCode': '54', 'acquirerMessage': 'Expired card', 'cardSecurityCode': {'acquirerCode': 'P', 'gatewayCode': 'NOT_PROCESSED'}, 'gatewayCode': 'EXPIRED_CARD'}, 'result': 'FAILURE', 'sourceOfFunds': {'provided': {'card': {'brand': 'VISA', 'expiry': {'month': '9', 'year': '26'}, 'fundingMethod': 'CREDIT', 'number': '413401xxxxxx4099', 'scheme': 'VISA'}}, 'type': 'CARD'}, 'timeOfRecord': '2021-08-24T07:00:19.719Z', 'transaction': {'acquirer': {'batch': 20210824, 'date': '0824', 'id': 'EASTERNBANK_S2I', 'merchantId': '50400002', 'settlementDate': '2021-08-24', 'timeZone': '+0600', 'transactionId': '301236252199379'}, 'amount': 95.0, 'currency': 'BDT', 'frequency': 'SINGLE', 'id': '1cb11ffb-3d20-4dbe-a738-df282b06ac0e', 'receipt': '123607242077', 'source': 'INTERNET', 'terminal': 'EASS2I05', 'type': 'PAYMENT'}, 'version': '43'}", "'amount': ", -1), ",", 1), "'", -2), "'", 1) as decimal) amount; 
	